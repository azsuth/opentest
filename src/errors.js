const vscode = require("vscode");

const { validExtension } = require("./utils");

const GENERIC_ERROR_WITH_MESSAGE = "generic_error_with_message";

function checkFileExtension(args) {
  const {
    document: { fileName }
  } = args;

  if (!validExtension(fileName)) {
    throw {
      ...args,
      errorCode: GENERIC_ERROR_WITH_MESSAGE,
      errorMessage: "Can only open tests for .js or .jsx files"
    };
  }

  return args;
}

function checkDocumentPath(args) {
  const { document } = args;

  if (!document.fileName.includes("/efflux/app/")) {
    throw {
      ...args,
      errorCode: GENERIC_ERROR_WITH_MESSAGE,
      errorMessage: "Can only open tests for files in /efflux/app/"
    };
  }

  return args;
}

function showErrorMessage(args) {
  const { errorMessage } = args;

  if (errorMessage) {
    vscode.window.showErrorMessage(errorMessage);
  }
}

module.exports = { checkDocumentPath, checkFileExtension, showErrorMessage };
